<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Library of Elements — FB Marketplace × Innovator's Dilemma Reverse Benchmark</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&family=DM+Sans:wght@400;500&display=swap" rel="stylesheet">
<style>
:root {
  --primary-purple: #31135D;
  --primary-purple-hover: #251047;
  --secondary-purple: rgb(109, 49, 194);
  --accent-purple: rgb(140, 104, 238);
  --text-dark: #1a1a1a;
  --text-gray: #6b7280;
  --text-description: #374151;
  --bg-white: #ffffff;
  --bg-light: #f9fafb;
  --bg-off-white: rgb(252, 250, 255);
  --border-color: #e5e7eb;
  --shadow-sm: 0 1px 3px rgba(0,0,0,0.05);
  --shadow-md: 0 2px 8px rgba(0,0,0,0.08);
  --shadow-purple-sm: 0 2px 4px rgba(49,19,93,0.2);
  --shadow-purple-md: 0 4px 8px rgba(49,19,93,0.15);
  --shadow-purple-lg: 0 6px 20px rgba(109,49,194,0.35);
  --rounded-lg: 8px;
  --rounded-xl: 12px;
  --rounded-pill: 20px;
}
*, *::before, *::after { margin: 0; padding: 0; box-sizing: border-box; }
body {
  font-family: 'DM Sans', sans-serif;
  background: var(--bg-light);
  color: var(--text-dark);
  min-height: 100vh;
}

/* ===== HEADER ===== */
.page-header {
  background: linear-gradient(135deg, #31135D 0%, rgba(109,49,194,0.92) 100%);
  padding: 48px 32px 40px;
  color: white;
  text-align: center;
  position: relative;
  overflow: hidden;
}
.page-header::before {
  content: '';
  position: absolute;
  inset: 0;
  background: radial-gradient(circle at 20% 80%, rgba(140,104,238,0.25) 0%, transparent 50%),
              radial-gradient(circle at 80% 20%, rgba(140,104,238,0.15) 0%, transparent 50%);
  pointer-events: none;
}
.header-content { position: relative; z-index: 1; max-width: 800px; margin: 0 auto; }
.header-content h1 {
  font-family: 'Inter', sans-serif;
  font-size: clamp(22px, 4vw, 32px);
  font-weight: 800;
  letter-spacing: -0.02em;
  margin-bottom: 10px;
}
.header-content p {
  font-size: 15px;
  opacity: 0.8;
  line-height: 1.6;
  max-width: 600px;
  margin: 0 auto;
}
.header-meta {
  display: flex;
  justify-content: center;
  gap: 24px;
  margin-top: 20px;
  flex-wrap: wrap;
}
.meta-chip {
  display: inline-flex;
  align-items: center;
  gap: 6px;
  padding: 6px 14px;
  background: rgba(255,255,255,0.12);
  border: 1px solid rgba(255,255,255,0.18);
  border-radius: var(--rounded-pill);
  font-family: 'Inter', sans-serif;
  font-size: 12px;
  font-weight: 600;
  color: rgba(255,255,255,0.9);
}

/* ===== FILTER BAR ===== */
.filter-bar {
  background: var(--bg-white);
  border-bottom: 1px solid var(--border-color);
  padding: 16px 32px;
  position: sticky;
  top: 0;
  z-index: 100;
  display: flex;
  gap: 12px;
  flex-wrap: wrap;
  align-items: center;
}
.filter-group {
  display: flex;
  align-items: center;
  gap: 8px;
}
.filter-label {
  font-family: 'Inter', sans-serif;
  font-size: 11px;
  font-weight: 600;
  text-transform: uppercase;
  letter-spacing: 0.06em;
  color: var(--text-gray);
  white-space: nowrap;
}
.filter-select {
  appearance: none;
  -webkit-appearance: none;
  padding: 7px 32px 7px 12px;
  border: 1.5px solid var(--border-color);
  border-radius: var(--rounded-pill);
  font-family: 'Inter', sans-serif;
  font-size: 12px;
  font-weight: 500;
  color: var(--text-dark);
  background: var(--bg-white) url("data:image/svg+xml,%3Csvg width='10' height='6' viewBox='0 0 10 6' fill='none' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M1 1L5 5L9 1' stroke='%236b7280' stroke-width='1.5' stroke-linecap='round' stroke-linejoin='round'/%3E%3C/svg%3E") no-repeat right 12px center;
  cursor: pointer;
  transition: border-color 0.2s;
}
.filter-select:hover, .filter-select:focus {
  border-color: var(--accent-purple);
  outline: none;
}
.filter-count {
  font-family: 'Inter', sans-serif;
  font-size: 12px;
  color: var(--text-gray);
  margin-left: auto;
}
.filter-count strong {
  color: var(--secondary-purple);
  font-weight: 700;
}

/* ===== GRID ===== */
.elements-grid {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(400px, 1fr));
  gap: 28px;
  padding: 32px;
  max-width: 1440px;
  margin: 0 auto;
}

/* ===== ELEMENT CARD ===== */
.element-card {
  background: var(--bg-white);
  border: 1px solid var(--border-color);
  border-radius: var(--rounded-xl);
  overflow: hidden;
  transition: transform 0.25s ease, box-shadow 0.25s ease;
  display: flex;
  flex-direction: column;
}
.element-card:hover {
  transform: translateY(-4px);
  box-shadow: 0 8px 24px rgba(109,49,194,0.18);
}
.card-iframe-wrap {
  width: 100%;
  height: 300px;
  border-bottom: 1px solid var(--border-color);
  background: var(--bg-light);
  overflow: hidden;
  position: relative;
}
.card-iframe-wrap iframe {
  width: 100%;
  height: 100%;
  border: none;
  display: block;
  transform-origin: top left;
}
.card-body { padding: 20px; flex: 1; display: flex; flex-direction: column; }

/* Card Header */
.card-header { display: flex; align-items: flex-start; gap: 12px; margin-bottom: 14px; }
.card-title {
  font-family: 'Inter', sans-serif;
  font-size: 17px;
  font-weight: 700;
  color: var(--primary-purple);
  flex: 1;
  line-height: 1.3;
}
.badge {
  display: inline-flex;
  align-items: center;
  padding: 3px 10px;
  border-radius: var(--rounded-pill);
  font-family: 'Inter', sans-serif;
  font-size: 10px;
  font-weight: 700;
  text-transform: uppercase;
  letter-spacing: 0.04em;
  white-space: nowrap;
  flex-shrink: 0;
}
.badge-category {
  background: rgba(109,49,194,0.1);
  color: var(--secondary-purple);
}
.badge-critical {
  background: rgba(127,29,29,0.08);
  color: #7f1d1d;
}
.badge-high {
  background: rgba(220,38,38,0.08);
  color: #dc2626;
}
.badge-medium {
  background: rgba(217,119,6,0.08);
  color: #d97706;
}
.badge-low {
  background: rgba(22,163,74,0.08);
  color: #16a34a;
}
.badges-row { display: flex; gap: 6px; flex-shrink: 0; flex-wrap: wrap; justify-content: flex-end; }

/* Problem */
.card-problem {
  font-size: 13px;
  color: var(--text-description);
  line-height: 1.6;
  margin-bottom: 14px;
}

/* Before/After */
.before-after { margin-bottom: 14px; }
.ba-row {
  display: flex;
  gap: 10px;
  padding: 10px 12px;
  border-radius: var(--rounded-lg);
  font-size: 12px;
  line-height: 1.55;
  color: var(--text-description);
}
.ba-row + .ba-row { margin-top: 6px; }
.ba-row.before { background: rgba(220,38,38,0.04); border-left: 3px solid rgba(220,38,38,0.3); }
.ba-row.after { background: rgba(22,163,74,0.04); border-left: 3px solid rgba(22,163,74,0.3); }
.ba-label {
  font-family: 'Inter', sans-serif;
  font-weight: 700;
  font-size: 10px;
  text-transform: uppercase;
  letter-spacing: 0.04em;
  flex-shrink: 0;
  width: 48px;
}
.ba-row.before .ba-label { color: #dc2626; }
.ba-row.after .ba-label { color: #16a34a; }
.ba-platform {
  font-family: 'Inter', sans-serif;
  font-weight: 600;
  font-size: 11px;
  color: var(--text-gray);
  margin-bottom: 4px;
}
.ba-emotional {
  font-style: italic;
  font-size: 11px;
  color: var(--accent-purple);
  margin-top: 4px;
}

/* Signature */
.card-signature {
  font-size: 12px;
  font-style: italic;
  color: var(--accent-purple);
  line-height: 1.55;
  padding: 10px 14px;
  background: rgba(140,104,238,0.05);
  border-radius: var(--rounded-lg);
  margin-bottom: 14px;
  border-left: 3px solid var(--accent-purple);
}

/* Journey Phases */
.phase-tags { display: flex; flex-wrap: wrap; gap: 6px; margin-bottom: 14px; }
.phase-tag {
  display: inline-flex;
  align-items: center;
  gap: 4px;
  padding: 4px 10px;
  border-radius: var(--rounded-pill);
  font-family: 'Inter', sans-serif;
  font-size: 10px;
  font-weight: 600;
  background: var(--bg-off-white);
  color: var(--primary-purple);
  border: 1px solid rgba(49,19,93,0.1);
}
.phase-tag::before {
  content: '';
  width: 6px;
  height: 6px;
  border-radius: 50%;
  background: var(--accent-purple);
}

/* Expand Toggle */
.expand-toggle {
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 6px;
  margin-top: auto;
  padding: 10px;
  border: none;
  background: none;
  cursor: pointer;
  font-family: 'Inter', sans-serif;
  font-size: 12px;
  font-weight: 600;
  color: var(--secondary-purple);
  transition: color 0.2s;
  border-top: 1px solid var(--border-color);
}
.expand-toggle:hover { color: var(--primary-purple); }
.expand-toggle svg {
  width: 14px; height: 14px;
  transition: transform 0.3s ease;
}
.expand-toggle.open svg { transform: rotate(180deg); }

/* Expanded Details */
.card-details {
  display: none;
  padding: 0 20px 20px;
  animation: slideDown 0.3s ease;
}
.card-details.visible { display: block; }
@keyframes slideDown {
  from { opacity: 0; transform: translateY(-8px); }
  to { opacity: 1; transform: translateY(0); }
}
.detail-section { margin-bottom: 16px; }
.detail-section:last-child { margin-bottom: 0; }
.detail-heading {
  font-family: 'Inter', sans-serif;
  font-size: 13px;
  font-weight: 700;
  color: var(--primary-purple);
  margin-bottom: 8px;
  display: flex;
  align-items: center;
  gap: 6px;
}
.detail-heading svg { width: 14px; height: 14px; color: var(--secondary-purple); }
.detail-table {
  width: 100%;
  font-size: 12px;
  border-collapse: collapse;
}
.detail-table td {
  padding: 5px 0;
  vertical-align: top;
  line-height: 1.5;
  color: var(--text-description);
}
.detail-table td:first-child {
  font-family: 'Inter', sans-serif;
  font-weight: 600;
  color: var(--text-gray);
  width: 110px;
  padding-right: 12px;
  white-space: nowrap;
}
.detail-list {
  list-style: none;
  font-size: 12px;
  color: var(--text-description);
  line-height: 1.6;
}
.detail-list li { padding: 3px 0; padding-left: 16px; position: relative; }
.detail-list li::before {
  content: '';
  position: absolute;
  left: 0;
  top: 10px;
  width: 6px;
  height: 6px;
  border-radius: 50%;
}
.detail-list.do-list li::before { background: #16a34a; }
.detail-list.dont-list li::before { background: #dc2626; }
.micro-chips { display: flex; flex-wrap: wrap; gap: 4px; margin-top: 4px; }
.micro-chip {
  padding: 3px 8px;
  background: var(--bg-off-white);
  border: 1px solid rgba(109,49,194,0.12);
  border-radius: 4px;
  font-family: 'Inter', sans-serif;
  font-size: 11px;
  color: var(--secondary-purple);
  font-weight: 500;
}

/* Overlap & Gap Section */
.overlap-chips { display: flex; flex-wrap: wrap; gap: 4px; margin-top: 6px; }
.overlap-chip {
  padding: 3px 8px;
  background: rgba(109,49,194,0.05);
  border: 1px solid rgba(109,49,194,0.1);
  border-radius: 4px;
  font-family: 'Inter', sans-serif;
  font-size: 10px;
  color: var(--secondary-purple);
  font-weight: 500;
}
.gap-text {
  font-size: 12px;
  color: var(--text-description);
  line-height: 1.55;
  margin-top: 8px;
  padding: 8px 12px;
  background: rgba(22,163,74,0.04);
  border-left: 3px solid rgba(22,163,74,0.3);
  border-radius: var(--rounded-lg);
}

/* ===== RESPONSIVE ===== */
@media (max-width: 860px) {
  .elements-grid {
    grid-template-columns: 1fr;
    padding: 20px 16px;
    gap: 20px;
  }
  .filter-bar { padding: 12px 16px; }
  .page-header { padding: 32px 20px 28px; }
}
@media (max-width: 480px) {
  .card-iframe-wrap { height: 240px; }
  .card-body { padding: 16px; }
  .card-title { font-size: 15px; }
  .filter-bar { gap: 8px; }
}
</style>
</head>
<body>

<!-- ===== HEADER ===== -->
<header class="page-header">
  <div class="header-content">
    <h1>Library of Elements</h1>
    <p>Facebook Marketplace &times; Innovator's Dilemma (Ch 8&ndash;9) Reverse Benchmark &mdash; UI components derived from competitive gap analysis through the lens of RPV framework disruption theory.</p>
    <div class="header-meta">
      <span class="meta-chip">
        <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"/><path d="M12 6v6l4 2"/></svg>
        Layer 4 Output
      </span>
      <span class="meta-chip">
        <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z"/><path d="M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z"/></svg>
        Innovator's Dilemma Ch. 8 &amp; 9
      </span>
      <span class="meta-chip">
        <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="3" y="3" width="18" height="18" rx="2"/><path d="M3 9h18"/><path d="M9 21V9"/></svg>
        7 Elements
      </span>
      <span class="meta-chip">
        <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M12 2L2 7l10 5 10-5-10-5z"/><path d="M2 17l10 5 10-5"/><path d="M2 12l10 5 10-5"/></svg>
        Competitor: Facebook Marketplace
      </span>
    </div>
  </div>
</header>

<!-- ===== FILTER BAR ===== -->
<div class="filter-bar" id="filterBar">
  <div class="filter-group">
    <span class="filter-label">Category</span>
    <select class="filter-select" id="filterCategory" onchange="applyFilters()">
      <option value="all">All Categories</option>
      <option value="trust">Trust</option>
      <option value="schedule">Schedule</option>
      <option value="proposal">Proposal</option>
      <option value="lifecycle">Lifecycle</option>
      <option value="relationship">Relationship</option>
    </select>
  </div>
  <div class="filter-group">
    <span class="filter-label">Priority</span>
    <select class="filter-select" id="filterPriority" onchange="applyFilters()">
      <option value="all">All Priorities</option>
      <option value="critical">Critical</option>
      <option value="high">High</option>
      <option value="medium">Medium</option>
    </select>
  </div>
  <div class="filter-group">
    <span class="filter-label">Journey Phase</span>
    <select class="filter-select" id="filterPhase" onchange="applyFilters()">
      <option value="all">All Phases</option>
      <option value="discovery">Discovery</option>
      <option value="search">Search</option>
      <option value="listing_evaluation">Listing Evaluation</option>
      <option value="proposal_creation">Proposal Creation</option>
      <option value="negotiation">Negotiation</option>
      <option value="acceptance">Acceptance</option>
      <option value="move_in">Move-in</option>
      <option value="active_lease">Active Lease</option>
      <option value="retention">Retention</option>
    </select>
  </div>
  <span class="filter-count" id="filterCount"><strong>7</strong> of 7 elements</span>
</div>

<!-- ===== GRID ===== -->
<main class="elements-grid" id="elementsGrid"></main>

<script>
// ===== ELEMENT DATA =====
var ELEMENTS = [
  {
    id: "rb-ui-010",
    name: "Verified Identity Trust Stack",
    category: "trust",
    priority: "high",
    journey_phases: ["listing_evaluation", "proposal_creation"],
    problem_it_solves: "Guests commit thousands of dollars based on a profile photo. Hosts like Patricia have been scammed twice. Tag\u2019s default assumption is fraud. No platform provides housing-specific trust signals -- the entire category relies on social media profiles as the sole proxy for trustworthiness.",
    why_this_is_a_signature: "No platform in any marketplace category provides a stacked, multi-source trust credential system designed for shared housing cohabitation. Moving from \u2018a profile photo and a prayer\u2019 to a layered verification display with progressive disclosure creates the single largest emotional shift in the housing search experience.",
    before_after: {
      before: { platform: "Facebook Marketplace", experience: "Guest sees a profile photo, a cover image, and \u2018Account since 2019.\u2019 No housing reviews, no verified identity, no response rate. Must Google the host\u2019s name, reverse-image-search listing photos, and check Street View. Patricia was scammed twice.", emotional_state: "Anxiety, suspicion, invisible labor" },
      after: { platform: "Split Lease", experience: "Guest opens a listing and sees a 92 Trust Score backed by 6 verification dimensions: ID verified, background checked, income verified, 14 housing reviews averaging 4.7, 2-hour response rate, and freshness confirmation.", emotional_state: "Relief, confidence, evidence-based decision-making" }
    },
    visual_spec: {
      layout: "Vertical stack, 280px wide, left-aligned next to host avatar",
      border_radius: "12px outer container, 8px per credential row",
      color_usage: "Verified: rgba(109, 49, 194, 0.08) bg with purple icon. Unverified: #f3f4f6 bg with gray icon. Fill bar: #31135D active, #e5e7eb empty."
    },
    interaction_spec: {
      default_state: "Collapsed \u2014 shows icon + label + verified/unverified badge per row",
      hover: "Row highlights with purple tint background",
      click: "Expands to show verification detail",
      animation: "Expand/collapse with 200ms ease-out transition"
    },
    copy_spec: {
      primary_text: "Trust Profile",
      secondary_text: "Based on 6 verification dimensions",
      micro_copy: ["Identity Verified", "Background Checked", "Income Verified", "Housing Reviews", "Response Rate", "Verified Available"],
      do_list: ["Show unverified fields as empty outlines, not hidden", "Use progressive disclosure for credential details"],
      dont_list: ["Never hide missing credentials \u2014 transparency builds trust", "Never inflate trust scores"]
    },
    effort: "medium",
    existing_library_overlap: ["works-009 (visual layer)", "rb-ui-002 (review filter)", "rb-ui-006 (commitment badge)"],
    gap_filled: "The library has visual patterns for displaying trust. This element provides the DATA ARCHITECTURE underneath: what credentials exist, how they stack, and the progressive-disclosure interaction pattern for the listing page.",
    html_css: "PLACEHOLDER"
  },
  {
    id: "rb-ui-011",
    name: "Schedule-First Search with Day-of-Week Selector",
    category: "schedule",
    priority: "critical",
    journey_phases: ["discovery", "search"],
    problem_it_solves: "No platform in any category can express schedule-based housing needs. Tom needs Mon-Thu. Walaa needs weekdays + every other weekend. Vince needs flexibility to drop from 2 nights to 1. Every marketplace search uses location/price/bedrooms \u2014 the concept of \u2018which nights do you need?\u2019 does not exist.",
    why_this_is_a_signature: "This IS Split Lease\u2019s reason for existence. Schedule-based housing search is the disruptive beachhead per Ch 9 \u2014 the attribute that traditional platforms dismiss as too niche but which, once properly served, redefines the category.",
    before_after: {
      before: { platform: "Facebook Marketplace", experience: "Tom, a student needing Mon-Thu housing, opens Marketplace. He types \u2018room available weeknights\u2019 \u2014 gets irrelevant results. He browses listings manually, messages each host to ask if they\u2019d consider a partial-week arrangement. Most don\u2019t respond.", emotional_state: "Frustration, alienation, \u2018nobody understands what I need\u2019" },
      after: { platform: "Split Lease", experience: "Tom opens Split Lease and sees \u2018Which nights do you need?\u2019 He taps Mon, Tue, Wed, Thu. The cost estimate updates live: \u2018$87/night \u00d7 4 nights \u00d7 4 weeks = $1,392/mo.\u2019 He hits \u2018Find Matches\u2019 and sees 14 listings from hosts who welcome exactly his schedule pattern.", emotional_state: "Relief, recognition, \u2018this platform was built for me\u2019" }
    },
    visual_spec: {
      layout: "Centered hero block, max-width 560px, stacked vertically",
      border_radius: "20px outer container, 50% day badges, 20px cost pill, 20px button",
      color_usage: "Day badge active: rgb(75, 71, 206) with white text. Cost estimate: rgba(49, 19, 93, 0.06) bg. CTA: gradient purple."
    },
    interaction_spec: {
      default_state: "Welcoming card with \u2018Which nights do you need?\u2019 and 7 day badges",
      hover: "Day badges gain purple border tint",
      click: "Toggle day selection. Multi-select. Live cost recalculation.",
      animation: "Selected badges pulse briefly (scale 1.05 for 100ms). Cost counter effect."
    },
    copy_spec: {
      primary_text: "Which nights do you need?",
      secondary_text: "Select the days you need a place. We\u2019ll find hosts who match your schedule.",
      micro_copy: ["M", "T", "W", "T", "F", "S", "S", "Find Matches", "$87/night \u00d7 3 nights \u00d7 4 weeks = $1,044/mo"],
      do_list: ["Make schedule the PRIMARY search axis, not an afterthought", "Show live cost projection as days are selected"],
      dont_list: ["Never default to location-first search", "Never require all 7 days \u2014 the power is in partial-week"]
    },
    effort: "large",
    existing_library_overlap: ["guest-communicates-006 (card-level hierarchy)", "guest-looks-006 (visual indicator)"],
    gap_filled: "The library has elements for displaying schedule fit on listing cards. This element provides the SEARCH-LEVEL entry point: the hero interaction where schedule selection IS the search.",
    html_css: "PLACEHOLDER"
  },
  {
    id: "rb-ui-012",
    name: "Schedule-Fit Listing Card",
    category: "schedule",
    priority: "critical",
    journey_phases: ["search", "listing_evaluation"],
    problem_it_solves: "Listing cards on every platform show property photos, price, and location. None show schedule compatibility or person-level information. A hybrid worker scanning results has no way to see which listings match their weekly pattern without clicking into each one.",
    why_this_is_a_signature: "A listing card that leads with schedule-fit percentage and day-of-week badges before showing price or photos inverts the entire information hierarchy of every marketplace in the category.",
    before_after: {
      before: { platform: "Facebook Marketplace", experience: "Listing cards show a photo, price, bedrooms, and location. Zero information about the host as a person. Zero information about schedule compatibility.", emotional_state: "Tedious, shot-in-the-dark browsing" },
      after: { platform: "Split Lease", experience: "Listing cards lead with a 7-dot schedule bar showing which days match, a percentage badge, the host\u2019s name and avatar, and a monthly cost projected for the guest\u2019s specific schedule.", emotional_state: "Efficient, informed, schedule-aware decision-making" }
    },
    visual_spec: {
      layout: "Card, 320px wide, vertical stack",
      border_radius: "12px",
      color_usage: "Schedule dots: matched = rgb(75, 71, 206), unmatched = #e5e7eb. Match badge: rgba(75, 71, 206, 0.1) bg. Host avatar: purple gradient."
    },
    interaction_spec: {
      default_state: "Schedule bar + host row + photo + price + tags",
      hover: "Subtle elevation increase, shadow transitions to purple-tinted",
      click: "Opens listing detail page",
      animation: "Photo lazy-loads as card enters viewport"
    },
    copy_spec: {
      primary_text: "92% match",
      secondary_text: "$1,044/mo for your Tue-Thu schedule",
      micro_copy: ["Sarah R. \u2014 Hosting since 2024", "$87/night", "Quiet after 10pm", "Dedicated workspace"],
      do_list: ["Lead with schedule compatibility, not property features", "Show monthly projection based on guest\u2019s selected schedule"],
      dont_list: ["Never hide the host \u2014 this is about people, not rooms", "Never show only nightly rate without monthly context"]
    },
    effort: "medium",
    existing_library_overlap: ["guest-communicates-006 (direct implementation)", "guest-looks-006 (direct implementation)"],
    gap_filled: "Implements the library\u2019s prescribed card hierarchy (schedule first, price second, property third) with production-ready HTML/CSS.",
    html_css: "PLACEHOLDER"
  },
  {
    id: "rb-ui-013",
    name: "Structured Proposal Builder with Smart Defaults",
    category: "proposal",
    priority: "high",
    journey_phases: ["proposal_creation", "negotiation", "acceptance"],
    problem_it_solves: "Housing negotiation happens through 47-message Messenger threads spread over days. Terms get lost in scroll-back. Paul abandoned the entire arrangement because it was \u2018too complicated.\u2019 Tammy explicitly asked Split Lease to \u2018create the arrangements.\u2019",
    why_this_is_a_signature: "No marketplace provides structured multi-dimensional housing negotiation. A proposal system that pre-populates 80% of terms from listing data and presents the guest with a confirmation task (not a construction task) transforms the highest-stakes moment.",
    before_after: {
      before: { platform: "Facebook Marketplace", experience: "Guest and host negotiate through 47 Messenger messages over 3 days. Terms discussed include rate, dates, deposit, cleaning, storage, and schedule. Everything is interleaved with questions about the kitchen and parking. Neither party can easily reference what was agreed.", emotional_state: "Overwhelmed, anxious about forgotten terms, depleted" },
      after: { platform: "Split Lease", experience: "Guest clicks \u2018Create Proposal\u2019 and sees a pre-populated card with schedule, rate, duration, deposit, and house rules already filled. They review, adjust duration to 12 weeks, and tap \u2018Send Proposal to Sarah.\u2019 Sarah counters the rate. Visual diff shows exactly what changed.", emotional_state: "Clarity, confidence, adults making a formal agreement" }
    },
    visual_spec: {
      layout: "Card, max-width 480px, vertical sections with dividers",
      border_radius: "16px outer, 12px summary section",
      color_usage: "Summary: rgb(252, 250, 255) bg. Edit links: rgb(109, 49, 194). Total: Inter 24px/700 primary-purple. Counter-offer diff: 3px secondary-purple left border."
    },
    interaction_spec: {
      default_state: "All fields pre-populated from listing + guest\u2019s search criteria",
      hover: "Edit links underline on hover",
      click: "Edit expands section to inline form. Changes highlighted with purple left-border.",
      animation: "Cost recalculates live with number animation"
    },
    copy_spec: {
      primary_text: "Your Proposal to Sarah",
      secondary_text: "$1,044/mo \u2014 $87/night \u00d7 3 nights \u00d7 4 weeks",
      micro_copy: ["Send Proposal to Sarah", "Edit", "Sarah adjusted some details", "Accept Terms", "Counter", "Decline"],
      do_list: ["Pre-populate 80%+ of fields from listing data", "Show visual diff for counter-offers"],
      dont_list: ["Never make the guest construct from scratch", "Never hide what changed in a counter-offer"]
    },
    effort: "large",
    existing_library_overlap: ["works-011 (direct match)", "works-013 (direct match)", "guest-behaves-004 (anxiety resolution)", "rb-ui-001 (post-acceptance artifact)"],
    gap_filled: "The library prescribes confirm-not-construct and anxiety-resolving status. This element provides the CONTENT ARCHITECTURE of the proposal itself: specific structured fields, smart defaults, visual diff for counter-offers, and the bidirectional negotiation flow.",
    html_css: "PLACEHOLDER"
  },
  {
    id: "rb-ui-014",
    name: "Active Stay Dashboard with Weekly Glance",
    category: "lifecycle",
    priority: "high",
    journey_phases: ["active_lease", "move_in"],
    problem_it_solves: "Every marketplace disappears after booking. The active stay \u2014 the longest and most consequential phase \u2014 receives zero product investment anywhere. Cristina pleads \u2018if you can do the work for me.\u2019 Tammy built an entire off-platform management empire.",
    why_this_is_a_signature: "Nobody expects a platform to be present during the stay. This is the beer sommelier \u2014 excellence in a space where nobody tries. A stay dashboard showing payment status, upcoming dates, house rules, and date-change tools would genuinely shock users.",
    before_after: {
      before: { platform: "Facebook Marketplace", experience: "After the arrangement is agreed, Facebook disappears. No move-in checklist. No payment tracker. No calendar. No date-change tools. Guest and host manage everything through scattered text messages and Venmo.", emotional_state: "Abandoned, on-your-own, cobbling together tools" },
      after: { platform: "Split Lease", experience: "On move-in day, the guest opens their Active Stay Dashboard: this week\u2019s dates and check-in time, a payment track showing Feb paid and Mar upcoming, quick-action buttons for date changes and messaging, and a 4-week calendar showing every stay night.", emotional_state: "Cared for, organized, confident the platform is present" }
    },
    visual_spec: {
      layout: "Full-width, single-scroll vertical layout, max-width 480px",
      border_radius: "16px hero, 12px actions, 8px calendar cells",
      color_usage: "Hero accent: purple gradient strip. Payment: purple filled = paid, outlined = upcoming, red = overdue. Calendar: stay nights in rgba(75, 71, 206, 0.15)."
    },
    interaction_spec: {
      default_state: "Current week hero card + payment track + quick actions + 4-week calendar",
      hover: "Action buttons gain purple border",
      click: "Each action navigates to respective tool",
      animation: "Pull-to-refresh updates payment status"
    },
    copy_spec: {
      primary_text: "Welcome back to Sarah\u2019s Place",
      secondary_text: "Tue Mar 3 \u2013 Thu Mar 5",
      micro_copy: ["This Week", "Check in after 3:00 PM Tuesday", "Cleaning verified", "Change Dates", "Message Sarah", "House Rules", "Report Issue"],
      do_list: ["Design for the 5-second weekly glance \u2014 one screen, full awareness", "Use exception-based notifications \u2014 silence means everything is fine"],
      dont_list: ["Never notify for on-time payments \u2014 only exceptions", "Never make the dashboard feel like work"]
    },
    effort: "large",
    existing_library_overlap: ["guest-works-003 (dashboard pattern)", "guest-works-001 (date changes)", "guest-feels-001 (emotional design)", "guest-communicates-004 (hero card)"],
    gap_filled: "The library has extensive coverage of individual lifecycle patterns. This element ASSEMBLES them into a single, integrated dashboard view that demonstrates what the complete active-stay experience looks like.",
    html_css: "PLACEHOLDER"
  },
  {
    id: "rb-ui-015",
    name: "Returning Guest Relationship Card",
    category: "relationship",
    priority: "medium",
    journey_phases: ["active_lease", "retention"],
    problem_it_solves: "Every platform treats each booking as independent, discarding accumulated trust. Tag has a seasonal tenant who \u2018loves the place but doesn\u2019t wanna be here winter\u2019 \u2014 no platform captures or facilitates that recurring relationship.",
    why_this_is_a_signature: "No platform in any category models the host-guest relationship as a first-class data object. A card that shows shared history, accumulated trust, established norms, and a one-tap \u2018Propose New Stay\u2019 button transforms the platform from a marketplace into a relationship manager.",
    before_after: {
      before: { platform: "Facebook Marketplace", experience: "After a successful 3-month arrangement, the guest wants to return. There is no \u2018rebook\u2019 button, no relationship history, no \u2018you previously stayed here\u2019 indicator. They send \u2018Is this still available?\u2019 \u2014 identical to a complete stranger.", emotional_state: "Frustration that the platform forgot them, transactional amnesia" },
      after: { platform: "Split Lease", experience: "Sarah opens her \u2018Your Guests\u2019 section and sees Marcus Kim\u2019s Relationship Card: gold \u2018Trusted Pair\u2019 tier ring, 4 stays, 4.9 rating, 48 total nights. A seasonal prompt says \u2018Spring is coming \u2014 reconnect for this season?\u2019 She taps \u2018Send Invite.\u2019", emotional_state: "Valued, remembered, partnership continuity" }
    },
    visual_spec: {
      layout: "Horizontal card, full-width, 96px height, flex row",
      border_radius: "12px",
      color_usage: "Tier rings: silver (#9ca3af) for 1 stay, purple for 2-3, gold gradient for 4+. CTA: secondary-purple bg, white text."
    },
    interaction_spec: {
      default_state: "Avatar with tier ring + name + stats + Propose New Stay button",
      hover: "Card gains purple border tint and shadow",
      click: "Opens full relationship profile with timeline",
      animation: "Tier-up animation on completing 4th stay"
    },
    copy_spec: {
      primary_text: "Your Guests / Your Hosts",
      secondary_text: "Connected since Nov 2024",
      micro_copy: ["Trusted Pair", "Returning Guest", "First Stay", "4 stays", "4.9 rating", "48 nights", "Propose New Stay", "Spring is coming \u2014 reconnect with Marcus?"],
      do_list: ["Show accumulated trust through visual tier progression", "Proactively prompt seasonal reconnection"],
      dont_list: ["Never start returning guests from zero", "Never hide relationship history"]
    },
    effort: "large",
    existing_library_overlap: ["rb-ui-004 (entry point)", "guest-behaves-007 (re-engagement notifications)"],
    gap_filled: "The library has minimal coverage of relationship-as-data-object. This element provides the concrete UI: relationship cards with tier progression, accumulated stats, seasonal prompting, and one-tap rebooking.",
    html_css: "PLACEHOLDER"
  },
  {
    id: "rb-ui-016",
    name: "Housing-Specific Review Dimensions",
    category: "trust",
    priority: "high",
    journey_phases: ["active_lease", "retention"],
    problem_it_solves: "Existing review systems (Airbnb\u2019s 5-star, Marketplace\u2019s thumbs-up) were designed for hospitality or goods, not cohabitation. A 4.8 from 200 Airbnb reviews tells you nothing about whether this host keeps the kitchen clean between ghost-roommate handoffs.",
    why_this_is_a_signature: "Purpose-built review dimensions for shared housing (cleanliness consistency, noise respect, communication, accuracy, rule adherence) represent a categorical leap from borrowed hospitality metrics. The reviews feed the Trust Stack and the Relationship Ledger, creating compounding trust architecture.",
    before_after: {
      before: { platform: "Facebook Marketplace / Airbnb", experience: "Marketplace has no reviews. Airbnb has a 5-star aggregate from short-stay hospitality guests. Neither tells you whether this host keeps the kitchen clean between ghost-roommate handoffs or respects quiet hours on weeknights.", emotional_state: "Guessing, hoping, making high-stakes decisions without relevant data" },
      after: { platform: "Split Lease", experience: "The listing shows 14 housing-specific reviews across 5 dimensions: Cleanliness 4.8, Communication 4.9, Accuracy 4.5, Quiet Hours 4.6, Rule Adherence 4.8. Each review is tagged with the guest\u2019s context (Remote Worker, 12-week stay, Tue-Thu).", emotional_state: "Informed, evidence-based confidence, the right data for the right decision" }
    },
    visual_spec: {
      layout: "Card, max-width 400px, vertical stack",
      border_radius: "12px outer, 8px dimension rows",
      color_usage: "Dimension dots: filled = rgb(109, 49, 194), empty = #e5e7eb. Pentagon chart: 0.15 opacity purple fill, solid purple stroke."
    },
    interaction_spec: {
      default_state: "Aggregate pentagon chart + individual dimension bars + review list",
      hover: "Review cards gain subtle shadow",
      click: "Filtering connects to People-Like-You Filter",
      animation: "Dimension dots fill on load with staggered animation"
    },
    copy_spec: {
      primary_text: "Housing Reviews",
      secondary_text: "14 reviews from past cohabitants",
      micro_copy: ["Cleanliness", "Communication", "Accuracy", "Quiet Hours", "Rule Adherence", "Remote Worker", "12-week stay", "Tue-Thu"],
      do_list: ["Use housing-specific dimensions, not hospitality metrics", "Tag reviews with guest context for filtering"],
      dont_list: ["Never use a single aggregate star rating as the primary signal", "Never borrow review categories from hotel/Airbnb patterns"]
    },
    effort: "medium",
    existing_library_overlap: ["rb-ui-002 (People-Like-You filter)", "works-009 (trust credential visual)"],
    gap_filled: "The library has the review FILTER (rb-ui-002) but no specification for what the reviews themselves contain. This element defines the review CONTENT: 5 housing-specific dimensions, dimensional scoring, tagged context, and the display format.",
    html_css: "PLACEHOLDER"
  }
];

// Load actual html_css from the JSON file
(function() {
  fetch('../layer-4/ui-elements.json')
    .then(function(r) { return r.json(); })
    .then(function(data) {
      if (data && data.elements) {
        data.elements.forEach(function(srcEl) {
          var match = ELEMENTS.find(function(e) { return e.id === srcEl.id; });
          if (match) {
            match.html_css = srcEl.html_css;
          }
        });
      }
      renderAll();
    })
    .catch(function() {
      // If fetch fails, render with placeholder iframes
      renderAll();
    });
})();

// ===== RENDER =====
function formatPhase(p) {
  return p.replace(/_/g, ' ').replace(/\b\w/g, function(c){ return c.toUpperCase(); });
}

function esc(s) {
  var d = document.createElement('div');
  d.textContent = s;
  return d.innerHTML;
}

function renderCard(el) {
  var priorityClass = 'badge-' + el.priority;
  var phases = el.journey_phases.map(function(p){ return '<span class="phase-tag">' + formatPhase(p) + '</span>'; }).join('');

  // Build before/after - handle nested object format
  var beforeText = '';
  var afterText = '';
  if (el.before_after) {
    if (typeof el.before_after.before === 'object') {
      beforeText = '<div class="ba-platform">' + esc(el.before_after.before.platform) + '</div>' +
        esc(el.before_after.before.experience) +
        '<div class="ba-emotional">' + esc(el.before_after.before.emotional_state) + '</div>';
      afterText = '<div class="ba-platform">' + esc(el.before_after.after.platform) + '</div>' +
        esc(el.before_after.after.experience) +
        '<div class="ba-emotional">' + esc(el.before_after.after.emotional_state) + '</div>';
    } else {
      beforeText = esc(el.before_after.before);
      afterText = esc(el.before_after.after);
    }
  }

  // Build detail sections
  var visualRows = '';
  if (el.visual_spec) {
    var vs = el.visual_spec;
    if (vs.layout) visualRows += '<tr><td>Layout</td><td>' + esc(vs.layout) + '</td></tr>';
    if (vs.border_radius) visualRows += '<tr><td>Radius</td><td>' + esc(vs.border_radius) + '</td></tr>';
    if (vs.color_usage) visualRows += '<tr><td>Color Usage</td><td>' + esc(vs.color_usage) + '</td></tr>';
  }

  var interactionRows = '';
  if (el.interaction_spec) {
    var is2 = el.interaction_spec;
    if (is2.default_state) interactionRows += '<tr><td>Default</td><td>' + esc(is2.default_state) + '</td></tr>';
    if (is2.hover) interactionRows += '<tr><td>Hover</td><td>' + esc(is2.hover) + '</td></tr>';
    if (is2.click) interactionRows += '<tr><td>Click</td><td>' + esc(is2.click) + '</td></tr>';
    if (is2.animation) interactionRows += '<tr><td>Animation</td><td>' + esc(is2.animation) + '</td></tr>';
  }

  var copyHtml = '';
  if (el.copy_spec) {
    var cs = el.copy_spec;
    var microChips = '';
    if (cs.micro_copy) {
      microChips = '<div class="micro-chips">' + cs.micro_copy.map(function(m){ return '<span class="micro-chip">' + esc(m) + '</span>'; }).join('') + '</div>';
    }
    var doList = '';
    if (cs.do_list && cs.do_list.length) {
      doList = '<div style="margin-top:8px"><strong style="font-size:11px;color:#16a34a;font-family:Inter,sans-serif">DO:</strong><ul class="detail-list do-list">' + cs.do_list.map(function(d){ return '<li>' + esc(d) + '</li>'; }).join('') + '</ul></div>';
    }
    var dontList = '';
    if (cs.dont_list && cs.dont_list.length) {
      dontList = '<div style="margin-top:8px"><strong style="font-size:11px;color:#dc2626;font-family:Inter,sans-serif">DON\'T:</strong><ul class="detail-list dont-list">' + cs.dont_list.map(function(d){ return '<li>' + esc(d) + '</li>'; }).join('') + '</ul></div>';
    }
    copyHtml = '<div class="detail-section"><div class="detail-heading"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"/></svg>Copy Spec</div>' +
      '<table class="detail-table"><tr><td>Primary</td><td>' + esc(cs.primary_text || '') + '</td></tr><tr><td>Secondary</td><td>' + esc(cs.secondary_text || '') + '</td></tr></table>' +
      '<div style="margin-top:8px"><strong style="font-size:11px;color:var(--text-gray);font-family:Inter,sans-serif">MICRO-COPY:</strong>' + microChips + '</div>' +
      doList + dontList +
      '</div>';
  }

  // Library overlap + gap filled
  var overlapHtml = '';
  if (el.existing_library_overlap && el.existing_library_overlap.length) {
    overlapHtml = '<div class="detail-section"><div class="detail-heading"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M12 2L2 7l10 5 10-5-10-5z"/><path d="M2 17l10 5 10-5"/><path d="M2 12l10 5 10-5"/></svg>Library Overlap &amp; Gap</div>' +
      '<div class="overlap-chips">' + el.existing_library_overlap.map(function(o){ return '<span class="overlap-chip">' + esc(o) + '</span>'; }).join('') + '</div>';
    if (el.gap_filled) {
      overlapHtml += '<div class="gap-text">' + esc(el.gap_filled) + '</div>';
    }
    overlapHtml += '</div>';
  }

  // Encode html_css for srcdoc
  var iframeHtml = '';
  if (el.html_css && el.html_css !== 'PLACEHOLDER') {
    var srcdoc = el.html_css.replace(/&/g, '&amp;').replace(/"/g, '&quot;');
    iframeHtml = '<iframe srcdoc="' + srcdoc + '" sandbox="allow-same-origin allow-scripts" loading="lazy" title="' + esc(el.name) + ' preview"></iframe>';
  } else {
    iframeHtml = '<div style="display:flex;align-items:center;justify-content:center;height:100%;font-family:Inter,sans-serif;font-size:13px;color:var(--text-gray)">Preview loading...</div>';
  }

  return '<div class="element-card" data-category="' + el.category + '" data-priority="' + el.priority + '" data-phases="' + el.journey_phases.join(',') + '">' +
    '<div class="card-iframe-wrap">' + iframeHtml + '</div>' +
    '<div class="card-body">' +
      '<div class="card-header">' +
        '<div class="card-title">' + esc(el.name) + '</div>' +
        '<div class="badges-row">' +
          '<span class="badge badge-category">' + el.category + '</span>' +
          '<span class="badge ' + priorityClass + '">' + el.priority + '</span>' +
        '</div>' +
      '</div>' +
      '<div class="card-problem">' + esc(el.problem_it_solves) + '</div>' +
      '<div class="before-after">' +
        '<div class="ba-row before"><span class="ba-label">Before</span><span>' + beforeText + '</span></div>' +
        '<div class="ba-row after"><span class="ba-label">After</span><span>' + afterText + '</span></div>' +
      '</div>' +
      '<div class="card-signature">' + esc(el.why_this_is_a_signature) + '</div>' +
      '<div class="phase-tags">' + phases + '</div>' +
      '<button class="expand-toggle" onclick="toggleDetails(this)">' +
        '<span>Full Specs</span>' +
        '<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><polyline points="6 9 12 15 18 9"/></svg>' +
      '</button>' +
    '</div>' +
    '<div class="card-details">' +
      '<div class="detail-section"><div class="detail-heading"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="3" y="3" width="18" height="18" rx="2"/><path d="M3 9h18"/><path d="M9 21V9"/></svg>Visual Spec</div>' +
      '<table class="detail-table">' + visualRows + '</table></div>' +
      '<div class="detail-section"><div class="detail-heading"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M15 15l-2 5L9 9l11 4-5 2z"/><path d="M2 2l7.586 7.586"/></svg>Interaction Spec</div>' +
      '<table class="detail-table">' + interactionRows + '</table></div>' +
      copyHtml +
      overlapHtml +
    '</div>' +
  '</div>';
}

function toggleDetails(btn) {
  var card = btn.closest('.element-card');
  var detail = card.querySelector('.card-details');
  var isOpen = detail.classList.contains('visible');
  detail.classList.toggle('visible');
  btn.classList.toggle('open');
  btn.querySelector('span').textContent = isOpen ? 'Full Specs' : 'Hide Specs';
}

function applyFilters() {
  var cat = document.getElementById('filterCategory').value;
  var pri = document.getElementById('filterPriority').value;
  var phase = document.getElementById('filterPhase').value;
  var cards = document.querySelectorAll('.element-card');
  var visible = 0;
  cards.forEach(function(card) {
    var cCat = card.dataset.category;
    var cPri = card.dataset.priority;
    var cPhases = card.dataset.phases;
    var matchCat = cat === 'all' || cCat === cat;
    var matchPri = pri === 'all' || cPri === pri;
    var matchPhase = phase === 'all' || cPhases.split(',').indexOf(phase) !== -1;
    var show = matchCat && matchPri && matchPhase;
    card.style.display = show ? '' : 'none';
    if (show) visible++;
  });
  document.getElementById('filterCount').innerHTML = '<strong>' + visible + '</strong> of ' + ELEMENTS.length + ' elements';
}

function renderAll() {
  var grid = document.getElementById('elementsGrid');
  grid.innerHTML = ELEMENTS.map(renderCard).join('');
}
</script>
</body>
</html>
